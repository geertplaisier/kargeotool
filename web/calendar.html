<!-- $Id: calendar.html 2274 2006-01-06 13:46:03Z Frank $ -->

<html>
    <head>
        <title>Calendar</title>
        <!-- This code can be reused as long as this copyright notice is not removed -->
        <!-- Copyright 1999 InsideDHTML.com, LLC.  All rights reserved.
             See www.siteexperts.com for more information.
        -->
        <style type="text/css">
            .today {color:navy; font-weight:bold}
            .days {font-weight:bold}
        </style>
        <link href="styles/intranet.css" rel="stylesheet" type="text/css">
        <script language="JavaScript">
		<!--
            var months = new Array(
                "Januari", "Februari", "Maart", "April", "Mei", "Juni", "Juli",
                "Augustus", "September", "October", "November", "December");

            var daysInMonth = new Array(
                31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31);

            var days = new Array(
                "Zondag", "Maandag", "Dinsdag", "Woensdag", "Donderdag",
                "Vrijdag", "Zaterdag");

            try {
                options = window.opener.calendarOptions;
            } catch(exception) {
                /* Internet Explorer... */
                options = window.dialogArguments;
            }

            function getDays(month, year) {
                // Test for leap year when February is selected.
                if(month == 1) {
                    leapYear = ((0 == year % 4) && (0 != (year % 100))) || (0 == year % 400);
                    return leapYear ? 29 : 28;
                } else {
                    return daysInMonth[month];
                }
            }

            function getToday() {
                // Generate today's date.
                this.now = new Date();
                this.year = this.now.getFullYear();
                this.month = this.now.getMonth();
                this.day = this.now.getDate();
            }

            // Start with a calendar for today.
            today = new getToday();

            function onLoad() {
                newCalendar();
            }

            function newCalendar() {

                today = new getToday();

                var parseYear = parseInt(document.all.year[document.all.year.selectedIndex].text);
                var newCal = new Date(parseYear, document.all.month.selectedIndex, 1);
                var day = -1;
                var startDay = newCal.getDay();
                var daily = 0;
                if((today.year == newCal.getFullYear()) && (today.month == newCal.getMonth())) {
                    day = today.day;
                }

                // Cache the calendar table's tBody section, dayList.
                var tableCal = document.all.calendar.tBodies.item(0);

                var intDaysInMonth =
                getDays(newCal.getMonth(), newCal.getFullYear());
                for(var intWeek = 0; intWeek < tableCal.rows.length; intWeek++) {
                    for (var intDay = 0; intDay < tableCal.rows[intWeek].cells.length; intDay++) {
                        var cell = tableCal.rows[intWeek].cells[intDay];

                        // Start counting days.
                        if ((intDay == startDay) && (0 == daily)) {
                            daily = 1;
                        }

                        // Highlight the current day.
                        cell.className = (day == daily) ? "today" : "";

                        // Output the day number into the cell.
                        if ((daily > 0) && (daily <= intDaysInMonth)) {
                            cell.innerHTML = daily++;
                        } else {
                            cell.innerHTML = "";
                        }

                        try {
                            cell.addEventListener("click", cellClickDOM, false);
                        } catch (exception) {
                            // Internet Explorer...
                        }
                    }
                }
            }

            /* Internet Explorer */
            function cellClickIE() {
                daySelected(event.srcElement.innerText);
            }

            /* Mozilla/Opera */
            function cellClickDOM(event) {
                daySelected(event.currentTarget.innerHTML);
            }

            function calNumFmt(number) {
                if(number.length == 1) {
                    return '0'+number;
                } else {
                    return number;
                }
            }

            function daySelected(day) {
                date = calNumFmt(day) + "-" + calNumFmt(document.all.month.value) + "-" + document.all.year.value;
                options.resultControl.value = date;
                window.close();
            }
		// -->
        </script>
    </head>
    <body onload="onLoad()">
    <table id="calendar">
        <thead>
            <tr>
                <td colspan="7" align="center">
                    <!-- Month combo box -->
                    <select id="month" onchange="newCalendar()">
                        <script language="JavaScript">
						<!--
                            // Output months into the document.
                            // Select current month.
                            for (var intLoop = 0; intLoop < months.length; intLoop++) {
                                document.write("<option value=" + (intLoop + 1) + " " +
                                    (today.month == intLoop ? "Selected" : "") + ">" + months[intLoop]);
                            }
						// -->
                        </script>
                    </select>

                    <!-- Year combo box -->
                    <select id="year" onchange="newCalendar()">
                        <script language="JavaScript">
						<!--
                            // Output years into the document.
                            // Select current year.
                            for (var intLoop = (today.year - 1); intLoop < (today.year + 4); intLoop++) {
                                document.write("<option value= " + intLoop + " " +
                                    (today.year == intLoop ? "Selected" : "") + ">" + intLoop);
                            }
						// -->
                        </script>
                    </select>
                </td>
            </tr>
            <tr class="days">
                <!-- Generate column for each day. -->
                <script language="JavaScript">
				<!--
                    // Output days.
                    for (var intLoop = 0; intLoop < days.length; intLoop++) {
                        document.write("<td>" + days[intLoop] + "</td>");
                    }
				// -->
                </script>
            </tr>
        </thead>
        <tbody id="dayList" align="center" onclick="cellClickIE()">
            <!-- Generate grid for individual days. -->
            <script language="JavaScript">
			<!--
                for (var intWeeks = 0; intWeeks < 6; intWeeks++) {
                    document.write("<tr>");
                    for (var intDays = 0; intDays < days.length; intDays++) {
                        document.write("<td></td>");
                    }
                    document.write("</tr>");
                }
			// -->
            </script>
        </tbody>
    </table>
    <center><input style="width:50pt" type=button class="knop" value="Annuleren" onclick="window.close();"></center>
    </body>
</html>
